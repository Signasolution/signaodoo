<odoo>
    <template id="product_pricelist_table" inherit_id="website_sale.product">
        <xpath expr="//div[@id='product_details']" position="inside">
            <t t-set="pricelist_items" t-value="product.get_pricelist_items_by_quantity()"/>
            <t t-if="pricelist_items">
                <div class="table-responsive mt-3">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Quantité minimale</th>
                                <th>Prix unitaire</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="pricelist_items" t-as="item">
                                <tr class="hoverable-row"
                                    t-att-data-qty="item['min_quantity']"
                                    style="cursor: pointer;">
                                    <td><t t-esc="item['min_quantity']"/></td>
                                    <td><t t-raw="item['currency'].symbol + ' ' + ('%.2f' % item['price'])"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
                <script type="text/javascript">
                    document.addEventListener('DOMContentLoaded', function () {
                        document.querySelectorAll('.hoverable-row').forEach(function (row) {
                            row.addEventListener('click', function () {
                                const qty = parseFloat(row.dataset.qty);
                                const input = document.querySelector('#quantity');
                                if (input) {
                                    input.value = qty;
                                    input.dispatchEvent(new Event('change'));
                                }
                                // Enlever la classe des autres lignes
                                document.querySelectorAll('.hoverable-row').forEach(r => r.classList.remove('selected-row'));
                                // Ajouter la classe à la ligne cliquée
                                row.classList.add('selected-row');
                            });
                        });
                    });
                </script>
                <style>
                    .hoverable-row:hover {
                        background-color: #f2f2f2;
                    }
                    .selected-row {
                        background-color: #d1e7dd !important;
                        font-weight: bold;
                    }
                </style>
            </t>
        </xpath>
    </template>
</odoo>
