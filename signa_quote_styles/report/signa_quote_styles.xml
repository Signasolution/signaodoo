<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Remplace l'appel au header standard par un routeur -->
    <template id="external_layout_router" inherit_id="web.external_layout" name="external_layout_router">
        <xpath expr="//t[@t-call='web.external_layout_header']" position="replace">
            <t t-call="signa_quote_styles.external_layout_header_router"/>
        </xpath>
    </template>

    <!-- Routeur de header : ne s'applique qu'aux devis/commandes (sale.order). Sinon header standard -->
    <template id="external_layout_header_router" name="external_layout_header_router">
        <t t-if="docs and docs._name == 'sale.order'">
            <t t-set="partner" t-value="docs and docs[0] and docs[0].partner_id"/>
            <t t-set="signa_style"
               t-value="(partner and partner._fields.get('x_studio_style_de_devis') and partner.x_studio_style_de_devis) or ''"/>

            <t t-if="signa_style == 'SignaSolution'" t-call="signa_quote_styles.signa_header_signasolution"/>
            <t t-elif="signa_style == 'SignaParc'" t-call="signa_quote_styles.signa_header_signaparc"/>
            <t t-elif="signa_style == 'SignaGolf'" t-call="signa_quote_styles.signa_header_signagolf"/>
            <t t-elif="signa_style == 'SignaIndustrie'" t-call="signa_quote_styles.signa_header_signaindustrie"/>
            <t t-else="" t-call="web.external_layout_header"/>
        </t>
        <t t-else="" t-call="web.external_layout_header"/>
    </template>

    <!-- 4 headers -->
    <template id="signa_header_signasolution" name="SignaSolution header">
        <div class="header">
            <div class="row">
                <div class="col-6"><strong>SignaSolution</strong></div>
                <div class="col-6 text-end"><span t-esc="company.name"/></div>
            </div>
            <div style="height:10px; background:#0b5cab; margin-top:6px;"></div>
        </div>
    </template>

    <template id="signa_header_signaparc" name="SignaParc header">
        <div class="header">
            <div class="row">
                <div class="col-6"><strong>SignaParc</strong></div>
                <div class="col-6 text-end"><span t-esc="company.name"/></div>
            </div>
            <div style="height:10px; background:#2e7d32; margin-top:6px;"></div>
        </div>
    </template>

    <template id="signa_header_signagolf" name="SignaGolf header">
        <div class="header">
            <div class="row">
                <div class="col-6"><strong>SignaGolf</strong></div>
                <div class="col-6 text-end"><span t-esc="company.name"/></div>
            </div>
            <div style="height:10px; background:#1b5e20; margin-top:6px;"></div>
        </div>
    </template>

    <template id="signa_header_signaindustrie" name="SignaIndustrie header">
        <div class="header">
            <div class="row">
                <div class="col-6"><strong>SignaIndustrie</strong></div>
                <div class="col-6 text-end"><span t-esc="company.name"/></div>
            </div>
            <div style="height:10px; background:#424242; margin-top:6px;"></div>
        </div>
    </template>

</odoo>
