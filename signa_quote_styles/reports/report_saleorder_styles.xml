<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
    Compatibility shim:
    Some customizations (Studio / other modules) expect a variable named `doc` in the sale order report.
    In Odoo 17+ the standard variable is usually `o` (inside foreach over `docs`).
    We define `doc` early from the first record to avoid KeyError in such snippets.
    -->
    <template id="report_saleorder_doc_alias" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="doc" t-value="docs and docs[0] or False"/>
        </xpath>
    </template>

    <!-- 4 styles distincts : SignaSolution / SignaParc / SignaGolf / SignaIndustrie -->
    <template id="report_saleorder_signasolution" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="signa_style" t-value="'SignaSolution'"/>
        </xpath>
        <xpath expr="//div[contains(concat(' ', normalize-space(@class), ' '), ' page ')]" position="before">
            <style>
                /* SignaSolution (exemple) */
                :root { --signa-accent: #0b5cad; }
            </style>
        </xpath>
    </template>

    <template id="report_saleorder_signaparc" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="signa_style" t-value="'SignaParc'"/>
        </xpath>
        <xpath expr="//div[contains(concat(' ', normalize-space(@class), ' '), ' page ')]" position="before">
            <style>
                /* SignaParc (exemple) */
                :root { --signa-accent: #2a6b2f; }
            </style>
        </xpath>
    </template>

    <template id="report_saleorder_signagolf" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="signa_style" t-value="'SignaGolf'"/>
        </xpath>
        <xpath expr="//div[contains(concat(' ', normalize-space(@class), ' '), ' page ')]" position="before">
            <style>
                /* SignaGolf (exemple) */
                :root { --signa-accent: #8a6f00; }
            </style>
        </xpath>
    </template>

    <template id="report_saleorder_signaindustrie" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="signa_style" t-value="'SignaIndustrie'"/>
        </xpath>
        <xpath expr="//div[contains(concat(' ', normalize-space(@class), ' '), ' page ')]" position="before">
            <style>
                /* SignaIndustrie (exemple) */
                :root { --signa-accent: #6e7781; }
            </style>
        </xpath>
    </template>
</odoo>
